"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.onRenderBody = void 0;

var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _react = _interopRequireDefault(require("react"));

var _fs = _interopRequireDefault(require("fs"));

var _path = _interopRequireDefault(require("path"));

var _lodash = _interopRequireDefault(require("lodash.isempty"));

var _createOptions2 = _interopRequireDefault(require("./create-options"));

var _google = require("./modules/google");

var _preconnect = _interopRequireDefault(require("./components/preconnect"));

var _preload = _interopRequireDefault(require("./components/preload"));

var _css = _interopRequireDefault(require("./components/css"));

var onRenderBody = function onRenderBody(_ref, pluginOptions) {
  var setHeadComponents = _ref.setHeadComponents;
  if ((0, _lodash["default"])(pluginOptions.fonts)) return;

  var _createOptions = (0, _createOptions2["default"])(pluginOptions),
      usePreload = _createOptions.usePreload,
      formats = _createOptions.formats,
      options = (0, _objectWithoutPropertiesLoose2["default"])(_createOptions, ["usePreload", "formats"]);

  var css = _fs["default"].readFileSync(_path["default"].join("./.cache", "webfonts", "webfonts.css"), "utf8");

  setHeadComponents([_react["default"].createElement(_preconnect["default"], {
    key: "webFontsPreconnectGoogleFonts",
    disabled: !(0, _google.isGooglePreconnectEnabled)(options),
    href: "https://fonts.googleapis.com"
  }), _react["default"].createElement(_preload["default"], {
    key: "webFontsPreload",
    disabled: !usePreload,
    format: formats[0],
    css: css
  }), _react["default"].createElement(_css["default"], {
    key: "webFontsCss",
    css: css
  })]);
};

exports.onRenderBody = onRenderBody;